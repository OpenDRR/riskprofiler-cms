name: WordPress fun!

on:
  push:
    branches:
    - main
  pull_request:
    branches:
    - main

jobs:
  #container-job:
  #  runs-on: ubuntu-20.04

  #container:
  #  image: wordpress:cli

  #services:
  #  mysql:
  #    image: mysql:5.7

  try-host-mysql:
    runs-on: ubuntu-20.04

    steps:
      - name: Start MySQL server
        run: |
          sudo systemctl status mysql.service || :
          sudo systemctl start mysql.service
          echo -e "[client]\nuser=root\npassword=root" > ~/.my.cnf
          chmod 0600 ~/.my.cnf

      - run: sudo mysql -e "SHOW DATABASES; CREATE DATABASE opendrr; SHOW DATABASES;" || true
      - run: sudo mysql -u root -e "SHOW DATABASES; CREATE DATABASE opendrr; SHOW DATABASES;" || true
      - run: mysql
